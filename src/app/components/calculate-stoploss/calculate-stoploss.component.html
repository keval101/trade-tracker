<div class="calculator">
    <!-- Header -->
    <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-8">
        <div>
            <h1 class="page-title mb-0">Stop Loss Calculator</h1>
            <p class="text-gray-500 text-sm mt-1">Calculate your stop loss and target prices</p>
        </div>
    </div>

    <div class="flex gap-8 flex-wrap">
        <!-- Stop Loss Calculator -->
        <div class="flex gap-4 flex-wrap flex-col flex-1 min-w-[300px]">
            <div class="trading-card border-l-4 border-l-red-500">
                <h3 class="text-lg font-semibold text-white mb-4">Stop Loss</h3>
                <form class="space-y-4" [formGroup]="stoplossForm">
                    <div>
                        <label for="sl_quantity" class="block mb-2 text-sm font-medium text-gray-300">Total Quantity</label>
                        <input type="number" name="sl_quantity" id="sl_quantity" class="form-input" placeholder="Enter total quantity" formControlName="quantity" min="0">
                    </div>
                    <div>
                        <label for="sl_amount" class="block mb-2 text-sm font-medium text-gray-300">Price per share</label>
                        <input type="number" name="sl_amount" id="sl_amount" class="form-input" placeholder="Enter price" formControlName="amount" min="0">
                    </div>
                    <div>
                        <label for="stoploss" class="block mb-2 text-sm font-medium text-gray-300">Stop Loss %</label>
                        <div class="relative" *ngIf="customStoplossLimit">
                            <div class="absolute m-0.5 bg-slate-700 inset-y-0 start-0 top-0 flex items-center px-3.5 rounded-s-md pointer-events-none text-gray-400">
                                %
                            </div>
                            <input type="number" name="stoploss" id="stoploss" class="form-input ps-14 mb-2" placeholder="Enter percentage" formControlName="stoploss" min="0">
                        </div>
                        <div class="grid grid-cols-3 gap-3">
                            <div class="sl-option cursor-pointer px-4 text-red-400 font-semibold py-2 rounded-lg flex justify-center items-center transition-colors"
                                [class.active]="stoplossForm.value.stoploss === 5"
                                (click)="setStoplossLimit(5)">5%</div>
                            <div class="sl-option cursor-pointer px-4 text-red-400 font-semibold py-2 rounded-lg flex justify-center items-center transition-colors"
                                [class.active]="stoplossForm.value.stoploss === 10"
                                (click)="setStoplossLimit(10)">10%</div>
                            <div class="sl-option cursor-pointer px-4 text-red-400 font-semibold py-2 rounded-lg flex justify-center items-center transition-colors"
                                [class.active]="stoplossForm.value.stoploss === 15"
                                (click)="setStoplossLimit(15)">15%</div>
                            <div class="sl-option cursor-pointer px-4 text-red-400 font-semibold py-2 rounded-lg flex justify-center items-center transition-colors"
                                [class.active]="stoplossForm.value.stoploss === 20"
                                (click)="setStoplossLimit(20)">20%</div>
                            <div class="sl-option cursor-pointer px-4 text-red-400 font-semibold py-2 rounded-lg flex justify-center items-center transition-colors"
                                [class.active]="stoplossForm.value.stoploss === 25"
                                (click)="setStoplossLimit(25)">25%</div>
                            <div class="cursor-pointer bg-slate-700 border border-slate-600 px-4 text-gray-300 font-semibold py-2 rounded-lg flex justify-center items-center hover:bg-slate-600 transition-colors"
                                (click)="customStoplossLimit = true">Custom</div>
                        </div>
                    </div>
                    <button type="submit" class="w-full btn-danger" (click)="calculateStopLoss()">Calculate Stop Loss</button>
                </form>
            </div>
        
            <div class="trading-card border-l-4 border-l-red-500" *ngIf="stopLossPrice">
                <p class="text-gray-300">Sell at or below: <span class="text-red-400 text-2xl font-bold">₹{{stopLossPrice.toFixed(2)}}</span></p>
                <p class="text-gray-300 mt-2">Potential Loss: <span class="text-red-400 text-xl font-semibold">₹{{(stoplossForm.value.quantity * (stoplossForm.value.amount - stopLossPrice)).toFixed(2)}}</span></p>
            </div>
        </div>
        
        <!-- Target Calculator -->
        <div class="flex gap-4 flex-wrap flex-col flex-1 min-w-[300px]">
            <div class="trading-card border-l-4 border-l-emerald-500">
                <h3 class="text-lg font-semibold text-white mb-4">Target Price</h3>
                <form class="space-y-4" [formGroup]="targetForm">
                    <div>
                        <label for="tgt_quantity" class="block mb-2 text-sm font-medium text-gray-300">Total Quantity</label>
                        <input type="number" name="tgt_quantity" id="tgt_quantity" class="form-input" placeholder="Enter total quantity" formControlName="quantity" min="0">
                    </div>
                    <div>
                        <label for="tgt_amount" class="block mb-2 text-sm font-medium text-gray-300">Price per share</label>
                        <input type="number" name="tgt_amount" id="tgt_amount" class="form-input" placeholder="Enter price" formControlName="amount" min="0">
                    </div>
                    <div>
                        <label for="target" class="block mb-2 text-sm font-medium text-gray-300">Target %</label>
                        <div class="relative" *ngIf="customTargetLimit">
                            <div class="absolute m-0.5 bg-slate-700 inset-y-0 start-0 top-0 flex items-center px-3.5 rounded-s-md pointer-events-none text-gray-400">
                                %
                            </div>
                            <input type="number" name="target" id="target" class="form-input ps-14 mb-2" placeholder="Enter percentage" formControlName="target" min="0">
                        </div>
                        <div class="grid grid-cols-3 gap-3">
                            <div class="tgt-option cursor-pointer px-4 text-emerald-400 font-semibold py-2 rounded-lg flex justify-center items-center transition-colors"
                                [class.active]="targetForm.value.target === 5"
                                (click)="setTargetLimit(5)">5%</div>
                            <div class="tgt-option cursor-pointer px-4 text-emerald-400 font-semibold py-2 rounded-lg flex justify-center items-center transition-colors"
                                [class.active]="targetForm.value.target === 10"
                                (click)="setTargetLimit(10)">10%</div>
                            <div class="tgt-option cursor-pointer px-4 text-emerald-400 font-semibold py-2 rounded-lg flex justify-center items-center transition-colors"
                                [class.active]="targetForm.value.target === 15"
                                (click)="setTargetLimit(15)">15%</div>
                            <div class="tgt-option cursor-pointer px-4 text-emerald-400 font-semibold py-2 rounded-lg flex justify-center items-center transition-colors"
                                [class.active]="targetForm.value.target === 20"
                                (click)="setTargetLimit(20)">20%</div>
                            <div class="tgt-option cursor-pointer px-4 text-emerald-400 font-semibold py-2 rounded-lg flex justify-center items-center transition-colors"
                                [class.active]="targetForm.value.target === 25"
                                (click)="setTargetLimit(25)">25%</div>
                            <div class="cursor-pointer bg-slate-700 border border-slate-600 px-4 text-gray-300 font-semibold py-2 rounded-lg flex justify-center items-center hover:bg-slate-600 transition-colors"
                                (click)="customTargetLimit = true">Custom</div>
                        </div>
                    </div>
                    <button type="submit" class="w-full btn-success" (click)="calculateTargetPrice()">Calculate Target</button>
                </form>
            </div>
        
            <div class="trading-card border-l-4 border-l-emerald-500" *ngIf="targetPrice">
                <p class="text-gray-300">Sell at or above: <span class="text-emerald-400 text-2xl font-bold">₹{{targetPrice.toFixed(2)}}</span></p>
                <p class="text-gray-300 mt-2">Potential Profit: <span class="text-emerald-400 text-xl font-semibold">₹{{(targetForm.value.quantity * (targetPrice - targetForm.value.amount)).toFixed(2)}}</span></p>
            </div>
        </div>
    </div>
</div>
